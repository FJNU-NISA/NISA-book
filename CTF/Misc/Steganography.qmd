# Steganography - 隐写技术

隐写技术最早应用于情报工作中，通过将机密信息隐藏在正常信息中，实现在数据监控下将机密信息进行外传。隐写技术广泛应用于图像、音频、文本等多种载体中。

---

## 图像隐写

图像隐写是将信息隐藏在图像文件中的技术，常用的方法包括 LSB 隐写、频域水印等。

### 图像文件基础

#### 图像 EXIF 元数据

- **EXIF**：Exchangeable Image File Format，是一种存储图像元数据的标准格式。
- **常见元数据**：拍摄时间、相机型号、GPS 位置等。
- **工具**：
  - `exiftool`：用于查看和编辑 EXIF 元数据。
  - `Exif Pilot`：图形化 EXIF 元数据编辑器。

#### RGB 像素

- **RGB**：Red, Green, Blue，三原色模式，用于描述像素的颜色。
- **ARGB**：Alpha, Red, Green, Blue，增加了 Alpha 通道，用于描述像素的透明度。

### 常见图像格式

#### PNG

- **特点**：无损压缩，支持透明通道。
- **隐写方法**：LSB 隐写、IDAT 块隐写。

#### JPG

- **特点**：有损压缩，文件体积较小。
- **隐写方法**：DCT 系数隐写。

#### GIF

- **特点**：支持动画，颜色数较少。
- **隐写方法**：调色板隐写。

#### BMP

- **特点**：无损压缩，文件体积较大。
- **隐写方法**：LSB 隐写。

### 图像 LSB 隐写

- **LSB**：Least Significant Bit，最低有效位。
- **原理**：将信息隐藏在像素的最低有效位中，对图像视觉效果影响较小。
- **工具**：
  - `Stegsolve`：用于分析 LSB 隐写。
  - `Steghide`：用于 LSB 隐写的嵌入和提取。

### 像素维度

- **概念**：描述图像的像素排列方式，常见于 BMP 文件格式。
- **应用**：通过调整像素维度隐藏信息。

### 盲水印

不同于常见的 LSB 水印，即使只是对像素的最低位进行操作，其从肉眼上仍可以直接分辨出（尤其是针对纯白图像），而频域隐写是直接从图像像素的频域内进行信息隐藏，肉眼无法直接看出原图与频域隐写后图像的区别，所以也常称作盲水印。

#### 频域水印

- **原理**：基于傅立叶变换，将信息隐藏在图像的频域中。
- **特点**：肉眼不可见，抗干扰能力强。
- **工具**：
  - `OpenCV`：用于实现频域水印。
  - `Matlab`：用于频域分析和处理。

#### 单图盲水印

- **原理**：在一张图像中嵌入水印信息。
- **应用**：版权保护、身份认证。

#### 双图盲水印

- **原理**：通过两张图像的差异提取水印信息。
- **应用**：高安全性场景。

#### 盲水印常见工具

- `BlindWatermark`：Python 实现的盲水印工具。
- `DCTWatermark`：基于 DCT 变换的盲水印工具。

### 图像隐写常见工具

#### Stegsolve

- **特点**：经典的图像隐写分析工具，支持多种隐写方法。
- **功能**：LSB 分析、通道分离、颜色过滤等。

#### StegoVeritas

- **特点**：命令行工具，支持自动化隐写分析。
- **功能**：像素分离、元数据提取、隐写检测。

#### Zsteg

- **特点**：专门针对 PNG 和 BMP 格式的隐写分析工具。
- **功能**：自动检测隐写数据，提取隐藏信息。

## 音频隐写

音频隐写是将信息隐藏在音频文件中的技术，常用的方法包括 LSB 隐写、频域隐写等。

### 常见音频文件格式

#### MP3

- **特点**：有损压缩，文件体积较小。
- **隐写方法**：LSB 隐写、频域隐写。

#### WAV

- **特点**：无损压缩，文件体积较大。
- **隐写方法**：LSB 隐写。

### 音频 LSB 隐写

- **原理**：将信息隐藏在音频样本的最低有效位中。
- **工具**：
  - `Audacity`：用于音频 LSB 隐写的分析和编辑。
  - `Sonic Visualiser`：用于音频频谱分析。

### 音频隐写常见工具

- `DeepSound`：支持音频隐写的嵌入和提取。
- `MP3Stego`：专门针对 MP3 文件的隐写工具。

## 编码隐写

编码隐写是将信息隐藏在文本或编码中的技术，常用的方法包括零宽隐写、Base64 隐写等。

### 零宽隐写

- **原理**：利用零宽字符（Zero-Width Characters）隐藏信息。
- **工具**：
  - `Snow`：用于零宽隐写的嵌入和提取。
  - `Zero-Width Characters`：在线零宽隐写工具。

### Base64 隐写

- **原理**：利用 Base64 编码的冗余空间隐藏信息。
- **工具**：
  - `Base64Stego`：用于 Base64 隐写的嵌入和提取。

### 编码隐写常见工具

- `StegOnline`：在线编码隐写工具，支持多种编码方式。
- `CyberChef`：多功能编码和隐写分析工具。

## 其他隐写

### pyc 隐写

- **原理**：将信息隐藏在 Python 编译文件（`.pyc`）中。
- **工具**：
  - `uncompyle6`：用于反编译 `.pyc` 文件。
  - `PyInstaller Extractor`：用于提取 `.pyc` 文件。

### NTFS 流隐写

- **原理**：利用 NTFS 文件系统的 Alternate Data Streams（ADS）隐藏信息。
- **工具**：
  - `Streams`：用于查看和编辑 NTFS 流。
  - `AlternateStreamView`：图形化 NTFS 流分析工具。

---

## 实践与练习

1. **图像 LSB 隐写**：使用 `Steghide` 将一段文本隐藏在 PNG 图像中，并使用 `Stegsolve` 提取。
2. **频域水印**：使用 `OpenCV` 实现频域水印的嵌入和提取。
3. **音频 LSB 隐写**：使用 `Audacity` 将一段文本隐藏在 WAV 文件中，并使用 `Sonic Visualiser` 分析。
4. **零宽隐写**：使用 `Snow` 将一段文本隐藏在普通文本中，并提取。
